<div class="words-query-wrapper pb-4">
  <form [formGroup]="form" (submit)="onQuerySubmit()" method="get" class="justify-content-center form-inline border p-5">
    <h4 class="mb-0 mr-5">Words Query</h4>

    <div class="input-group mr-2">
      <label class="sr-only" for="filterSongTitle">Name</label>
      <input type="text" matInput [matAutocomplete]="auto" id="filterSongTitle" class="form-control" placeholder="&quot;californiacation&quot;" formControlName="song" aria-describedby="filterSongTitleHelp">
      <small id="filterSongTitleHelp" class="form-text" >Optional. Filter by song title.</small>
      <div class="songs-loader-wrapper position-absolute">
        <mat-spinner *ngIf="showSongsSpinner" [diameter]="18"></mat-spinner>
      </div>
    </div>
    <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
      <mat-option *ngFor="let option of songsOptions" [value]="option">
        {{option.title}}
      </mat-option>
    </mat-autocomplete>


    <label class="sr-only" for="filterWordTerm">Word Term</label>
    <div class="input-group mr-sm-2">
      <div class="input-group-prepend">
        <div class="input-group-text">@</div>
      </div>
      <input type="text" class="form-control" id="filterWordTerm" placeholder="&quot;this&quot;" formControlName="wordTerm" aria-describedby="filterWordTermHelp">
      <small id="filterWordTermHelp" class="form-text">Optional. Filter by specific word or part ot it.</small>
    </div>

    <div class="input-group ml-1 mr-3 flex-column align-items-start">
      <div class="form-check">
        <input class="form-check-input" type="radio" formControlName="queryType" id="listQueryType" value="list">
        <label class="form-check-label font-size-80" for="listQueryType">
          As List
        </label>
      </div>

      <div class="form-check">
        <input class="form-check-input" type="radio" formControlName="queryType" id="indexQueryType" value="index">
        <label class="form-check-label font-size-80" for="indexQueryType">
          As Index
        </label>
      </div>
    </div>

    <button type="submit" class="btn btn-primary align-self-start">Submit</button>
  </form>

  <div *ngIf="showLoader; else resultsBlock" class="loader-wrapper">
    <mat-spinner [diameter]="50" class="my-5"></mat-spinner>
  </div>

  <ng-template #resultsBlock>
    <div *ngIf="words?.length > 0" class="results mt-4">
      <div class="container mb-4">
        <div class="row">
          <div *ngFor="let word of words | paginate: {
          itemsPerPage: wordsPerPage,
          currentPage: page,
          totalItems: wordsCount
          }"
               class="col-md-1 col-sm-2 col-3"
          >
            <div class="word-item d-flex flex-column my-1 py-2 border-bottom justify-content-between align-items-end">
              <span class="d-flex align-self-start"><em>{{word.value}}</em></span>
              <span class="word-meta d-flex align-self-start"><small>Line:{{word.line}} Stanza: {{word.stanza}}</small></span>
            </div>
          </div>
        </div>
      </div>

      <div class="pagination-wrapper">
        <pagination-controls (pageChange)="pageChanged($event)" autoHide="true" class="pagination-controls hide-page-numbers text-center"></pagination-controls>
      </div>
    </div>

    <div *ngIf="(wordsIndex | json) != '{}'" class="results index-results my-4">
      <div class="container">
        <div class="row">
          <div *ngFor="let word of wordsIndex | keyvalue" class="word-index-wrapper col-md-1 col-sm-2 col-3 mb-2 text-center">
            <a [ngClass]="['word', 'badge', 'badge-success']" (click)="onWordIndexClick($event, word.key, word.value)">
              {{ word.key }} <span class="badge badge-light">{{ word.value.length }}</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </ng-template>

</div>
